service firebase.storage {
  match /b/{bucket}/o {
    match /posts/{postId}/{imageId} {     
      // Allow write files to the path "posts/*/*", subject to the constraints:
      // 1) File is less than 0.1MB
      // 2) Content type is an image
      // 3) File name (stored in imageId wildcard variable) is less than 32 characters
      // 4) Delete file
      allow read;
      allow write: if request.resource.size < 0.1 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*')
                   && imageId.size() < 32
                   || request.resource == null
    }
  }
}
